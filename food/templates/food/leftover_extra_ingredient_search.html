<body>
    <!-- ✅ 완료시 돌아갈 곳: leftover 전용 선택화면 -->
    <a href="{% url 'food:select_recent_ingredients' %}" aria-label="뒤로가기">✕</a>

    <h2>재료 직접 담기</h2>
    <p>따로 구매할 재료가 있다면 직접 추가해보세요!</p>

    <!-- 검색창 -->
    <form method="get" action="{% url 'food:leftover_extra_ingredient_search' %}">
        <input type="text" name="search" value="{{ search_query|default:'' }}">
        <button type="submit" name="action" value="search">🔍</button>
    </form>

    <!-- 검색 결과 -->
    {% if category_ingredients %}
        <ul>
        {% for ing in category_ingredients %}
            <li>
            <form method="post" action="{% url 'food:leftover_add_extra_ingredient' %}">
                {% csrf_token %}
                <input type="hidden" name="search" value="{{ request.GET.search }}">
                <label>
                <input type="checkbox" name="ingredient" value="{{ ing.name }}" onchange="this.form.submit()">
                {{ ing.name }}
                </label>
            </form>
            </li>
        {% endfor %}
        </ul>
    {% endif %}

    <hr>

    <!-- 최근 검색어 (Leftover 전용) -->
    <h3>최근 검색어</h3>
    <div>
        {% if recent_searches %}
        <a href="{% url 'food:clear_extra_recent_searches' %}">전체삭제</a><br>
        {% for word in recent_searches %}
            <span style="margin-right:12px;">
            <a href="{% url 'food:leftover_extra_ingredient_search' %}?search={{ word|urlencode }}">{{ word }}</a>
            <a href="{% url 'food:delete_extra_recent_search' word %}" aria-label="{{ word }} 삭제">×</a>
            </span>
        {% endfor %}
        {% else %}
        <span>최근 검색어가 없습니다.</span>
        {% endif %}
    </div>

    <hr>

    <hr>

    <h3>추가한 재료</h3>
    {% if selected_ingredients %}
    <ul>
        {% for ing in selected_ingredients %}
        <li>
            <a href="{% url 'food:leftover_remove_extra_ingredient' ing.name %}">{{ ing.name }}</a>
        </li>
        {% endfor %}
    </ul>
    {% else %}
    <p>아직 추가한 재료가 없습니다.</p>
    {% endif %}


    <!-- 완료: 다시 선택화면으로 -->
    <a href="{% url 'food:select_recent_ingredients' %}" class="btn">완료</a>

    {% if messages %}
        <ul>
        {% for message in messages %}
            <li>{{ message }}</li>
        {% endfor %}
        </ul>
    {% endif %}
</body>
